<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../contents/bootstrap/css/cyborg.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../contents/custom/css/popnCustom.css">
    <title>popN</title>
  </head>
  <body onload="init();">
    
    <form onsubmit="onSubmit(); return false;">
        <input type="text" id="input">
        <input type="submit" value="Send">
        <button onclick="onCloseClick(); return false;">close</button>
      </form>
      <div id="log"></div>
      
    <script type="text/javascript">

        var ws;
        
        function init() {
    
          // Connect to Web Socket
          ws = new WebSocket("ws://popn.ml:9001/");
    
          // Set event handlers.
          ws.onopen = function() {
            output("onopen");
          };
          
          ws.onmessage = function(e) {
            // e.data contains received string.
            output("onmessage: " + e.data);
          };
          
          ws.onclose = function() {
            output("onclose");
          };
    
          ws.onerror = function(e) {
            output("onerror");
            console.log(e)
          };
    
        }
        
        function onSubmit() {
          var input = document.getElementById("input");
          // You can send message to the Web Socket using ws.send.
          ws.send(input.value);
          output("send: " + input.value);
          input.value = "";
          input.focus();
        }
        
        function onCloseClick() {
          ws.close();
        }
        
        function output(str) {
          var log = document.getElementById("log");
          var escaped = str.replace(/&/, "&amp;").replace(/</, "&lt;").
            replace(/>/, "&gt;").replace(/"/, "&quot;"); // "
          log.innerHTML = escaped + "<br>" + log.innerHTML;
        }
    
      </script>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script>let $ = require('jquery');</script>
    <script>require('popper.js');</script>
    <script>require('bootstrap');</script>
    <script src="../contents/custom/js/popnCustom.js"></script>
  </body>
</html>